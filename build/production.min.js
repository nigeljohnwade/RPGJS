function Inventory(){this.items={Weapons:[],Armors:[],Charms:[],Potions:[],Plot:[],Miscellany:[]},this.itemCount=0}function nonPlayerCharacter(a,b,c,d,e){this.stats=[],this.stats.melee=a,this.stats.ranged=b,this.stats.special=c,this.stats.toughness=d,this.wounds=3,this.woundsAt=3,this.woundsInflicted=0,this.status="healthy",this.attackChance=50,this.damage=1,this.defence=1,this.weaponID=0,this.armorID=0,this.inventory=new Inventory,this.name=e}function playerCharacter(a,b,c,d,e){this.stats=[],this.stats.melee=a,this.stats.ranged=b,this.stats.special=c,this.stats.toughness=d,this.wounds=3,this.woundsAt=3,this.woundsInflicted=0,this.status="healthy",this.attackChance=50,this.damage=1,this.defence=1,this.weaponID=null,this.armorID=null,this.inventory=new Inventory,this.name=e}function rpgConsole(a){this.content=[],this.writeCount=0,this.id=a,this.output=""}var Armors={armors:[{armorDamageModifier:1,armorName:"Plain Clothes"},{armorDamageModifier:1.1,armorName:"Cheap Leather"},{armorDamageModifier:1.2,armorName:"Sturdy Leather"},{armorDamageModifier:1.3,armorName:"Hardened Leather"},{armorDamageModifier:1.4,armorName:"Rigid Linen"}],getArmorDamageModifier:function(a){return this.armors[a].armorDamageModifier},getArmorName:function(a){return this.armors[a].armorName}},Combat={basicMeleeAttack:function(a){if("melee"===Weapons.weapons[a.weaponID].weaponStyle){for(var b,c,d=a.getMelee(),e=[],f=0;d>f;f++)b=100*Math.random()-a.attackChance,b>0&&e.push(b);return c=this.inflictDamage(e,a.getDamage()).damage,{damage:c,message:a.getWeapon()+" to attack and inflicts "+c}}return{message:a.name+" is not using a melee weapon"}},basicRangedAttack:function(a){if("ranged"===Weapons.weapons[a.weaponID].weaponStyle){for(var b,c=a.getRanged(),d=0,e=0;c>e;e++)100*Math.random()>a.attackChance&&d++;return b=this.inflictDamage(d,a.getDamage()).damage,{damage:b,message:a.getWeapon()+" to attack and inflicts "+b}}return{message:a.name+" is not using a ranged weapon"}},inflictDamage:function(a,b){var c=a.length,d=0;return d=c*b,{damage:d,message:c+" hits for "+d+" damage"}},receiveDamage:function(a,b){b-=a.getResilience();var c=Math.round(Math.max(b/a.woundsAt,0));return a.amendProperty("woundsInflicted",c),{wounds:c,message:a.name+" receives "+c+" wounds"}}};Inventory.prototype.getItem=function(a,b){return this[b].id},Inventory.prototype.getItemCount=function(){return this.itemCount},Inventory.prototype.addItem=function(a,b){this.itemCount=this.items[b].unshift(a)},Inventory.prototype.removeItem=function(a,b){this[b].splice(id,1),this.itemCount-=1},nonPlayerCharacter.prototype.getMelee=function(){return this.stats.melee},nonPlayerCharacter.prototype.getRanged=function(){return this.stats.ranged},nonPlayerCharacter.prototype.getSpecial=function(){return this.stats.special},nonPlayerCharacter.prototype.getToughness=function(){return this.stats.toughness},nonPlayerCharacter.prototype.getDamage=function(){return this.getMelee()*this.damage},nonPlayerCharacter.prototype.getStatus=function(){return{status:this.status,message:this.name+" is "+this.status}},nonPlayerCharacter.prototype.getResilience=function(){return this.defence*this.stats.toughness},nonPlayerCharacter.prototype.getHealth=function(){return"Health is "+parseInt(Math.max(0,this.wounds-this.woundsInflicted))+"/"+this.wounds},nonPlayerCharacter.prototype.amendStat=function(a,b){this.stats[a]=this.stats[a]+b,this.updateStatus()},nonPlayerCharacter.prototype.setStat=function(a,b){this.stats[a]=b},nonPlayerCharacter.prototype.amendProperty=function(a,b){this[a]=this[a]+b,this.updateStatus()},nonPlayerCharacter.prototype.setProperty=function(a,b){this[a]=b},nonPlayerCharacter.prototype.updateStatus=function(){return this.woundsInflicted>this.wounds?this.die():this.woundsInflicted>0?this.injured():""},nonPlayerCharacter.prototype.die=function(){return this.status="dead",this.hideCard("opponent"),this.name+" is dead"},nonPlayerCharacter.prototype.injured=function(){return this.status="injured",this.name+" is injured"},nonPlayerCharacter.prototype.getWeapon=function(){return this.name+" is using "+weapons.getWeaponName(this.weaponID)},nonPlayerCharacter.prototype.setWeapon=function(a){return this.weaponID=a,this.damage=this.damage*weapons.getWeaponDamageModifier(a),this.name+" switches to "+weapons.getWeaponName(this.weaponID)},nonPlayerCharacter.prototype.getArmor=function(){return this.name+" is wearing "+Armors.getArmorName(this.armorID)},nonPlayerCharacter.prototype.setArmor=function(a){return this.armorID=a,this.defence=this.defence*Armors.getArmorDamageModifier(a),this.name+" changes into "+Armors.getArmorName(this.armorID)},nonPlayerCharacter.prototype.showCard=function(a){var b=document.getElementById(a),c="";c+='<h1 class="nonPlayerCharacter">'+this.name+"</h1>";for(var d in this.stats)c+='<p class="stat">'+d+': <span class="value"> '+this.stats[d]+"</span></p>";c+="<p>"+this.getWeapon()+"</p>",c+="<p>"+this.getArmor()+"</p>",c+="<p>"+this.getHealth()+"</p>",c+="<p>"+this.getStatus().message+"</p>",b.innerHTML=c},nonPlayerCharacter.prototype.hideCard=function(a){var b=document.getElementById(a),c="";b.innerHTML=c;var d=document.getElementById("basicMeleeAttack_badGuy");d.innerText="Back to map",d.onclick=backToMap},playerCharacter.prototype.getMelee=function(){return this.stats.melee},playerCharacter.prototype.getRanged=function(){return this.stats.ranged},playerCharacter.prototype.getSpecial=function(){return this.stats.special},playerCharacter.prototype.getToughness=function(){return this.stats.toughness},playerCharacter.prototype.getDamage=function(){return this.getMelee()*this.damage},playerCharacter.prototype.getStatus=function(){return{status:this.status,message:this.name+" is "+this.status}},playerCharacter.prototype.getResilience=function(){return this.defence*this.stats.toughness},playerCharacter.prototype.getHealth=function(){return"Health is "+parseInt(Math.max(0,this.wounds-this.woundsInflicted))+"/"+this.wounds},playerCharacter.prototype.amendStat=function(a,b){this.stats[a]=this.stats[a]+b,this.updateStatus()},playerCharacter.prototype.setStat=function(a,b){this.stats[a]=b},playerCharacter.prototype.amendProperty=function(a,b){this[a]=this[a]+b,this.updateStatus()},playerCharacter.prototype.setProperty=function(a,b){this[a]=b},playerCharacter.prototype.updateStatus=function(){return this.woundsInflicted>this.wounds?this.die():this.woundsInflicted>0?this.injured():""},playerCharacter.prototype.die=function(){return this.status="dead",this.name+" is dead"},playerCharacter.prototype.injured=function(){return this.status="injured",this.name+" is injured"},playerCharacter.prototype.getWeapon=function(){return this.name+" is using "+weapons.getWeaponName(this.weaponID)},playerCharacter.prototype.setWeapon=function(a){for(var b=0;b<this.inventory.items.Weapons.length;b++)if(this.inventory.items.Weapons[b]===a)return this.weaponID=a,this.damage=this.damage*weapons.getWeaponDamageModifier(a),this.name+" switches to "+weapons.getWeaponName(this.weaponID)},playerCharacter.prototype.getAttackType=function(){return weapons.getWeaponType(this.weaponID)},playerCharacter.prototype.getArmor=function(){return this.name+" is wearing "+Armors.getArmorName(this.armorID)},playerCharacter.prototype.setArmor=function(a){for(var b=0;b<this.inventory.items.Armors.length;b++)return this.inventory.items.Armors[b]===a?(this.armorID=a,this.defence=this.defence*Armors.getArmorDamageModifier(a),this.name+" changes into "+Armors.getArmorName(this.armorID)):!1},playerCharacter.prototype.showCard=function(a){div=document.getElementById(a),html="",html+='<h1 class="playerCharacter">'+this.name+"</h1>";for(var b in this.stats)html+='<p class="stat">'+b+': <span class="value"> '+this.stats[b]+"</span></p>";html+="<p>"+this.getWeapon()+"</p>",html+="<p>"+this.getArmor()+"</p>",html+="<p>"+this.getHealth()+"</p>",html+="<p>"+this.getStatus().message+"</p>",div.innerHTML=html},rpgConsole.prototype.log=function(a,b){this.writeCount=this.content.unshift({theClass:a,theText:b});var c='<p class="{theClass}">{theText}</p>';for(var d in this.content[0])c=c.replace("{"+d+"}",this.content[0][d]);this.output=c+this.output},rpgConsole.prototype.display=function(){document.getElementById(this.id).innerHTML=this.output},timer=function(a,b,c){this.t=0,this.elapsed=0,this.timeString="",this.timeOut=a||0,this.step=b||1e3,this.callback=c||null,this.identifier=null},timer.prototype.updateTimer=function(){this.elapsed=(new Date).getTime()-this.t,this.elapsed>this.timeOut&&(this.elapsed=null,clearInterval(this.identifier),this.timedOut())},timer.prototype.timedOut=function(){this.t=null,null!==this.callback&&this.callback.call(this)},timer.prototype.startTimer=function(){this.t=(new Date).getTime(),this.identifier=setInterval(timer.prototype.updateTimer,this.step)},timer.prototype.getTimerElapsed=function(){return this.elapsed},timer.prototype.getTimeString=function(){return this.elapsed=new Date((new Date).getTime()-this.t),this.timeString=this.elapsed.getMinutes()>0?this.elapsed.getMinutes()+":":"00:",this.timeString+=this.elapsed.getSeconds()<10?"0"+this.elapsed.getSeconds():this.elapsed.getSeconds(),this.timeString};